# Encoding and retrieval of connectome

The connectome determines the computations performed by a neural network.
A lot of the functions of the brain are learned through interaction with an organism's environment.
However, the brain is highly structured from early development, and is capable of complex behavior before interacting with any external environment.
Neuro-development happens unsupervised, no external mechanism arranges how cells specialize or which neuron synapses with which other neuron.
Therefore, it follows that some connectivity information should be contained in the genome of organisms.
While the genome of many beings are available, it is unknown how much of the genomic information stores connectivity information, or how this information is stored.
The amount of information contained within the genome and the amount needed to encode a connectome can be estimated.
The human genome contains about 3 billion nucleotides, and around 30-50\
The transmittable information in the genome exist in the form of the possible base pairs of a nucleotide (4 possible bases) and the methylenation status (2 possible states, methylenated or not methylenated) of a base pair.
While this is a simplification, the amount of information that can be stored in a base-pair can be roughly estimated to be 3 bytes, using Shannon entropy as the measure of information.
The amount of information contained in the genome, $I_{DNA}$ about the brain structure then can be estimated;
<EQN HERE>
Considering that the brain has approximately $10^{8}$~neurons, the information contained in the connectome can also be estimated.
Ignoring the strength of connections and treating the connectome as a binary matrix, the information corresponds to the number of entries in the connectivity matrix.
The connectivity matrix is a square with each side $10^{8}$ entries long;
<EQN HERE>
While these approximations are crude, it demonstrates that the raw connectome cannot be stored in the genome.
The brain is built during neuro-development, therefore it is necessarily generated by cellular algorithms.
In this case, it might be more useful to expand the concept of Kolmogorov complexity to the brain.
In computer science, Kolmogorov complexity ~ of an output corresponds to the length of the shortest computer program that can generate that output.
Likewise, in the genome only the instructions of constructing a brain will be present, which will be much less than $1 EiB$ needed to store the raw connectome, and these instructions will be decoded to construct the brain during neuro-development.
Gene expression in the brain is widely studied, the specifics of how the assembly information is stored, and how exactly does gene expression impact the structuring of the connectome is largely unknown.
There is great evidence that larger scale structure are determined by early gene expression, called the protomap hypothesis.~
Evidence exists of existence of repeated connectivity patterns that are more granular; single-cell level motifs.~
Some animals have predetermined circuitry that do complex tasks, such as path integration in ants.
~
In this chapter, the limitations regarding encoding and decoding connectivity information is discussed.
This task is described as connectome cloning; duplicating the connectome of one network on a separate network through a self-assembly algorithm.

## Locality of connectome coding

In artificial neural networks, connectivity information storage and retrieval is almost trivial from the principals of computation.
A supervisor (CPU) reads from a memory location and writes this information on another memory information, decoding if needed.
This is possible because read and write operations are global algorithms with digital computers, a supervisor has access to the whole state of the memory and can manipulate it.
In neuro-development however, retrieval of the genome and transcribing into connectivity is not as simple.
There is no supervisor that assembles that reads cell states and assemble them.
The cellular machinery is done through self-assembly, where cells transmit local signals to nearby cells, and individual cells need to differentiate using information available only local to them.
For example, chemical gradients projected by stem cells influence the structuring of brain regions, and this information is local to neurons differentiating and forming synapses.
~
At no point does an external supervisor choose and dictate a neuron to differentiate into a specific form.
Any algorithm that stores connectivity information has the locality condition when concerning biological viability.
That is, each cell can only make use of information locally available to them.
The instructions executed by a cell cannot make use of information pertaining some other cell that's not in contact.
This condition demonstrates that a computer algorithm analogue cannot work on neural development.

## SYNseq method for connectome imaging

An analogous question in neural imaging is efficient reading of the connectome.
Multiple methods have been employed in doing this, we describe one novel method used to image the cell-level connectome of a neuronal section.
The SYNseq method utilizes RNA labels to do imaging, making use of readily available high-throughput sequencing technology.~
In SYNseq, each neuron is tagged with a unique nucleotide sequence; called an RNA barcode.
These barcodes are shuttled to the synapses through engineered proteins, and the barcodes of pre-synaptic cell and the post-synaptic cell are made to combine into a single sequence.
Later, this tissue is extracted, and the sample containing sequences of barcode pairs are sequenced.
The library of barcode pair sequences are used to reconstruct the connectivity information.
This workflow is depicted in .
While this connectome imaging technique is in development, it shows the proof of concept on how local mechanisms can be used to generate a netlist representation of the connectome.
Netlist representation of a network can be stored as a sequence, as demonstrated by using nucleotide sequences to do imaging.
It is also of note that if the connectome is a sparse graph, the netlist representation contains a compressed representation than the entire connectome matrix.

## Connectome cloning

Since there is a viable method to encode a connectome using cellular mechanisms, it is plausible that similar data can be used to decode a connectome using cellular mechanisms.
The target task is formulated is the following model; if the library of barcode-pair of some initial neural network is available to a separate neural network, can the secondary neural network evolve to have the identical connectome?
This problem formulation is depicted in .
This task will be referred to as connectome cloning, cloning the connectivity of one neural network on to another.
The model will involve possible actions that neurons can take while making use of barcode-pair information available locally.

### Mechanism for connectome cloning

We begin the model with the barcode-pair list from the initial network.
The initial network neurons are each labelled with unique barcode sequences.
Therefore a sequence uniquely identifies a cell in the original network.
For each synapse in the original network, the barcode-pair list has a sequence corresponding to the pre-synaptic cell, followed by the sequence of the post-synaptic cell.
For now, we will assume that the barcode-pairs are directional; meaning that which sequence is pre-synaptic and which sequence is the post-synaptic cell's sequence is readable from the barcode-pair.
We denote $N$ as the original network size in neurons, and the specific neurons are denoted using indices ranging from $1$ to $N$.
The matrix of the original network's connectome will be denoted as $W_{}$, where it is $1$ if the synapse $$ is present in the original network, and $0$ if not.
We will denote a barcode-pair of the $i$'th synapse with $P_i$, where the index $i$ ranges over the number of synapses $S$ of the initial network.
($i  {1, ... , S}$)
Then for each entry of $W_{}$ there will be a corresponding $i$ such that $P_i$ has the sequence of the barcodes of the $$'th cell and the $$'th cell.
The number of cells in the initial network is $N$, and we refer to the cells in the original network by their ID number.
Originating from the initial network, we propose that these barcode-pairs are made available to a disjoint, tabula-rasa, neural network in development.
For our initial model, this new neural network is all-to-all connected, meaning every possible synapse in the network exists.
Through cellular mechanisms, the barcode-pairs are to be moved throughout the network and placed on synapses, with each end of the barcode-pair corresponding to the pre and post synaptic barcode placed inside the corresponding cell.
After the barcode-pairs are distributed in a fashion, we suggest that the tabula-rasa network goes through a pruning stage, where every synapse that does not have a barcode-pair anchoring the two cells together gets eliminated.
Our model will propose that if certain conditions are met, which can be determined locally, the pruning results in a clone of the original network graph.
This methodology is depicted in .

### Barcode-pair movements

We will use $[^{pre}]{P}{_i}$ to refer to the pre-synaptic neuron of $P_i$, and $[^{post}]{P}{_i}$ to refer to the post-synaptic neuron of $P_i$.
To model local movements, we will postulate that the barcode-pairs can be moved as described in , and a depiction can be seen in .
These rules are formulated to be viable for a single cell to perform.
Indeed, all the locomotion in these rules involve the barcode-pair to be moving through the cell of interest.
The barcode-pairs can be pulled into the cytoplasm of one neuron that it is facing, and moved to another synapse that this cell is doing.

### Local state of tabula-rasa network

The distribution of barcode-pairs induce a state of the tabula-rasa network.
This state is depicted with the synapse–barcode connection index (SBCI), and is of the form $x{_n_m_,__}$.
The state is a binary array, that can take on values $1$ and $0$.
$x{_n_m_,__} = 1$ if there is a barcode-pair with the sequence corresponding to the $$ synapse of the original network, on the $n  m$ synapse of the tabula-rasa network.
This state comes with the constraint of coming from the original network.
For any distribution of the barcode-pairs in the tabula-rasa network, $_{n,m} x{_n_m_,__} = W_{}$ should always hold.
This is a global state of the system, and not separated between the cells.
The information available to each cell in this system is limited to the barcode that points inside the cell.
We can calculate the local state of a cell $c_{n}$ however, which is the number of barcodes that a cell has within it's body.
The barcodes are contributed from all the barcode-pairs that contain the barcode from the cell $$ from the original network.
The contributions are both from the cell $n$ being the pre-synaptic cell, and the post-synaptic cell.
Then each cell $n$ have access to $c_{n} = _{m} x{_n_m_,__} +  x{_m_n_,__}$.
This local state is available to a cell in the tabula-rasa network, and cells can move towards optimizing quantities regarding this state in this problem formulation.

One thing of note is that when all the barcode-pairs are distributed in a way to make every barcode pointing towards one cell of one sequence, there is a one-to-one correspondance between the neurons of the original network and the neurons of the tabula-rasa network.
The neuron in the tabula-rasa network that has the barcode with the sequence of the original network have this one-to-one mapping.
This mappinng is shown in , when each cell is identified with the hue of the barcode sequence it contains uniquely.
This state is denoted the one-barcode-one-cell (OBOC) state, where $c_{n}$ is non-zero only for one barcode type $_n$,
and no barcode type is duplicated across cells $_n = _m  n = m$.
We note that if the pruning stage happens during an OBOC state, then the connectome of tabula-rasa network is equivalent to the original network.

Let $W_B$ be the target connectivity matrix defined by the barcode-pairs.
Let $W_N$ be a connectivity matrix after of an OBOC distribution of the same barcode-pairs after barcode-free synapses are eliminated.
Then, a one-to-one mapping $M$ exists between the set of barcodes and the neurons, such that $W_B = M W_N M^$.

If OBOC solution is reached, then there is a unique barcode in each cell of the tabula-rasa network, and there is a unique tabula-rasa cell for each unique barcode.
We define the matrix $P$ with entries $P_{ n} = 1$ when the barcode of the original networks' $$ is found in the $n$ neuron in the tabula-rasa network.
Since the tabula-rasa is in the OBOC state, $P_{ n} = 1$ implies ${P_{ n} = 0 \;    }$ due to unique barcode type per each tabula-rasa cell, and ${P_{ m} = 0 \;  m  n}$ due to a single barcode type per each tabula-rasa cell.
$P$ then is a permutation, satisfying ${PP^ = PP^{-1} = 1}$
Application of permutation on the connectivity matrix of the OBOC state of the tabula-rasa network, ${PW_N P^} =$ produces a matrix with entries $_{ } = 1$ only when there is a barcode-pair between the tabula-rasa neurons that collected the barcode $$ and $$.
Such a barcode-pair exists iff the original network had a synapse between the associated neurons; $(W_B)_{ } = 1$.
$_{ } = 1$ iff $(W_B)_{ } = 1$, $0$ otherwise, making these matrices the same matrix.
$= W_B$
Therefore, for an OBOC distribution, $W_B = P W_N P^$

### Local cost function of the tabula-rasa network

While the system has moves that it can use to reach an OBOC state; the cells need to perform these movements with the information available to them.
The OBOC state can be thought of as two conditions, that barcodes of the same sequence are brought within one cell and barcodes of different sequence are prevented to be in the same cell.
From these principle, we suggest the following cost function determined from the local variables of each cell in the tabula-rasa network.
<EQN HERE>
This cost function has parameters $$ and $$.
The intuition behind this cost function is that the left-hand side, when $> 1$ and $> 1$, reduce the cost function when the $c_{n}$ is sparse in the $$ index.
Therefore the left-hand side corresponds to an attraction between barcodes of the same sequence.
The right-hand term raises the cost of having too much barcodes in one cell, essentially acting as a repulsion between barcodes.
The balancing of the two terms with the $$ parameter indeed yields the minimum of this cost function as OBOC state.
It can be proven in the case where $= 2$ and the system is quadratic, that all non-OBOC states have moves that can reduce the cost function.
[Theorem 2]
For the cost function with $= 2$ and $> 1$, a non-OBOC state always has some barcode jump that decreases the cost function.

For , for a barcode type $$ to be relocated from cell $m$ to cell $n$ with a flip, the change in cost function is calculable as follows.
<EQN HERE>
If the tabula-rasa network is in non-OBOC state; that means one, or both, of the following must be true.

A barcode is shared between cells; there is a $$, $j$, $k$ such that
${c_{j }  0  c_{k }}$
A cell has multiple barcodes; there is a $$, $$, $j$ such that
${c_{j }  0  c_{j }}$

In the case where a barcode is shared between two cells, we look at the following sum.
<EQN HERE>
Since the sum of these is a negative number, at least one has to be a negative number, corresponding to a flip that decreases the cost function.
If it's not the case where any barcode is shared between cells and the barcode-pair distribution is not OBOC,
then there must be at least one cell $l$ with no barcodes.
Choosing $$ to be the barcode that is the least abundant, such that ${c_{j }  c_{j } \;     \, c_{j } > 0}$, we look at the following change in cost function.
<EQN HERE>
Since $1$, the change is cost function is always negative, thus this flip reduces the cost function.
Under all conditions where the solution is not OBOC, a flip that reduces the cost function exists.

Following from , it follows that minima of the cost function under the parameters are all OBOC.

For the cost function with $= 2$ and $> 1$, all minima are OBOC states.

Since all OBOC states are equivalent to the original connectome via a permutation, all OBOC states are also equivalent via a permutation.
The cost function in is invariant under permutation, thus all OBOC states have the same value of the cost function.
If state is not OBOC, cost function can always be reduced.
Cost function is bounded below and above by the constraints on the system counts, therefore there is a maximum and minimum value for the cost function.
There is no minima that is not an OBOC state, since if the system is not in an OBOC state, there is a different state that is guaranteed to have lower cost function.
Since there are minima, then minima must be OBOC.
Since all OBOC states are permutations, and permutation leaves the cost invariant, all OBOC states are minima.

The connectome cloning problem, within the constraints discussed, then is possible with the given moveset as long as this cost function can be preferentially decreased.
One other constraint that we can observe on the system is the reachability of OBOC state from a non-OBOC distribution in finite amount of time.
[Theorem 3]
For the cost function with $= 2$ and $> 1$, convergence to a minimum state of the cost function takes a number of states limited above by a polynomial of the number of cells in the network.

The cost-function spectrum is discrete and limited.
For example, if $$ is a natural number, then the cost function is an integer number.
The lower boundary of the cost-function spectrum corresponds to an OBOC solution (), and equals to ${−f^2 N^3}$ where $f$ is the connection density.
As we start with a random distribution of the barcodes, the higher boundary approximately equals to ${ f^2 N^3}$. Therefore, the number of successful steps to the convergence cannot exceed ${( 1 +  ) f^2 N^3}$. In every non-OBOC state, there is at least one in $fN^4$ barcode jumps, decreasing the cost function ().
Thus, the overall number of the steps to convergence does not exceed ${(1+)f^3 N^7}$, which is polynomial.

## Simulating connectome cloning

To demonstrate this formulation, several computational simulations are performed.
The simulations consists of generating initial network connectivities of various topologies, number of neurons ($N$) and synaptic density ($f$).
Then the barcode-pair list of this network is extracted, and distributed onto another network.
The barcode-pair distribution of the new network is simulated using Metropolis Monte Carlo (MMC) procedure, which is chosen due to parallels to the dynamics of synaptic connections during neural development.
~
The simulations are run until OBOC state is reached, at which we look at the number of MMC steps attempted ($N_{steps}$) by the simulation before convergence, as a measure of convergence time.
Results are displayed in .
The target connectomes were generated to be Erdős–Rényi~ networks and scale-free (using Barabási–Albert algorithm).~
To more accurately model if this scheme is viable in a situation where the barcode-pair relocation and pruning happens simultaneously, we also ran simulations with dynamic synapses.
In the dynamic synapses case, the tabula-rasa network is not all-to-all connected, but still connected in a density higher than the original network.
Barcode-pairs are distributed to existing synapses randomly, and can only move to existing synapses.
During simulation (100 times) the network randomly makes some new synapses and eliminates some old ones if the synapse does not have a barcode-pair.
Pruning is still performed upon reaching an OBOC state.
We call this simulation "dynamic synapses", and note that this simulation models the synapse formation rate during cortical development.~
In all the cases, the steps required for convergence is polynomial in network density, and convergence is reached for all simulations.
The convergence time needed to reach OBOC state from random distribution is found to be a polynomial relationship with network density $$ and size $N$, (or also equivelantly to the number of synapses $S =  N^2$), consistent with the upper limit set by .
<EQN HERE>

## Conclusion

There is evidence that network connectivity on some scale is encoded in the genome.
And we provided a proof of concept for decoding such information from genomics data.
While the provided methods does not claim that this is the mechanism for connectome reconstruction from the genome, it is suggested that this information can be stored as a sequence and can be retrieved.
And this encoding and decoding is viable to happen on cell-level granularity.
This proposed methodology successfully reproduces the cell-level network, but in principle can also be applied to larger scale structures and their bulk connections as well.
